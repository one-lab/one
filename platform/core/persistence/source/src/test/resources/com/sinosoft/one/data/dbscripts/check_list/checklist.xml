<?xml version="1.0" encoding="UTF-8"?>
<dbscripts namespace="queryCheckList" xmlns="http://www.vmars.org/dbscript" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.vmars.org/dbscript ../../../../dbscript.xsd ">
  <dbscript type = "sql" id = "selectCurrentDept">
     select distinct res_dept id, res_dept_name name
       from T_EM_DEPT_CHECKLIST
      where common_plan_id = ?
        and checklist_exist = 1
        and res_dept is not null
  </dbscript>
  <dbscript type="sql" id="selectCurrentPlan">
  	 select a.id id, b.name name
      from t_em_plan a, t_em_plan_type b
     where a.effective = 1
       and a.plan_type = b.id
       and a.plan_attr = 0 
       and a.plan_exist = 1
  </dbscript>
  <dbscript type="sql" id="selectCheckListByDept"> select  task_name task_name,
       	       task_type task_type,
       	       time_limit time_limit,
       	       equipment equipment,
		       case when res_dept is not null then res_dept_name 
               else null 
               end  res_dept_name,
               rm num
		  from T_EM_DEPT_CHECKLIST
		 where checklist_exist = 1 
		   and common_plan_id = ?
		   and res_dept=?
		 order by rm
  </dbscript>
  <dbscript type="sql" id="selectAllCheckList">
       select  task_name task_name,
       	       task_type task_type,
       	       time_limit time_limit,
       	       equipment equipment,
		       case when res_dept is not null then res_dept_name 
               else null 
               end  res_dept_name,
               rm num
		  from T_EM_DEPT_CHECKLIST
		 where common_plan_id = ?
		   and checklist_exist = 1
		 order by rm
    </dbscript>
</dbscripts>